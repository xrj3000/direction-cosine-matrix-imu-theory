# 加速度计

由于水平姿态有零飘，所以采用加速度计对横滚角和俯仰角漂移进行修正。我们必须考虑离心加速度，其中能够被解释说明的（机体运动加速度）情况，将会接下来会进行讨论。

我们成员之一BILL在建立他的第一块板子的时候，他认为加速度计完全可以靠自己进行横滚俯仰控制，然而由于一系列原因并不是这样。主要是因为加速度计测量的是运动加速度和重力加速度之和。如果加速度计仅测量重力加速度，这样计算将没有任何问题；但是加速度计还测量运动加速度，所以会带来问题。BILL曾经尝试在手推出滑翔机的时候，仅基于加速度计输出稳住机体俯仰角，推出产生的运动加速度错误地估计出飞机俯仰朝上进行控制，控制反馈让机体笔直俯冲向下。

通常加速度计的工作机理就是测量弹簧拉一小质量块的形变。由于加速度计的动态固有频率较高，所以加速度计响应灵敏。弹簧形变大小取决于质量块上受到的所有力，这个力等于质量块质量乘以重力加速度矢量和运动加速度矢量之和。（常规迹象来说，加速度计测量的是重力加速度减去运动加速度）

所以除了重力加速度，加速度计还测量运动加速度，这并不惊讶，因为它就叫加速度计。
因此，加速度计只有在飞机不处于加速运动状态，才能准确估计横滚和俯仰角。问题是飞机经常加速运动，其中一些运动加速度，比如离心运动加速度，在没有飞机动态模型情况下，是很容易计算和补偿的。然而，却很难辨别计算出向前的运动加速度。

还有一线生机。一般来说，飞机不是在向前加速运动，而是时而加速时而减速的运动，因此它的运动加速度过程在相互抵消。一架飞机不可能一直加速向前运动，直到空气阻力使其速度不能更快；一架飞机也不可能一直减速运动，不然停止将从天上掉下。由于加速度计没有漂移，所以只要我们不依赖于加速度计实现高动态响应，我们还是可以用加速度计来修正陀螺漂移带来的横滚俯仰误差。

目前市场上有很多好的加速度计，其中大部分采用DCM算法将工作良好。加速度计并不像陀螺仪这么关键，因为加速度计零偏上的任何变化不会产生误差的累积，但是陀螺仪会。因为加速度计是直接测量角度，而陀螺仪是测量角度随时间变化的速率的。

加速度计有许多种接口类型，包括模拟电压、脉宽调制以及一些标准的通信接口。我们选择了一个加速度计，采用最为简单的接口方式即模拟电压输出。

采用方向余弦方法的最大好处是，在飞机任何方向角度时都能实现，计算没有任何奇异或者特别的逻辑。飞机任何角度方向可以采用方向余弦矩阵的9个元素充分描述。 由于我们需要校正漂移，来计算飞机的任何方向角度，所以我们将需要测量沿着飞机三个轴的加速度。这个可以用市面上三轴一体的加速度计实现，或者三个独立的加速度计实现。

在我们能够使用加速度计信息来补偿横滚和俯仰角漂移之前，我们必须考虑离心加速度和飞机向前运动的速度变化量。虽然飞机向前加速或者减速运动时间比较短，但是它可以无限的转动下去。

幸运的是，所需要来计算离心加速度的信息一应俱全，离心加速度等于转动角速度和线速度的叉乘积。我们不需要一个确切的答案，一般来说也只有一个确切的答案。一般来说，飞机在指定的方向运动，因此我们假设飞机的速度矢量方向平行于飞机的X轴，GPS给我们提供飞机对地的速度大小，由于大地是一个惯性参考系，我们可以计算出飞机机体系下的速度矢量，也就是在X方向的对地速度。

在机体参考坐标系中，我们计算离心加速度为陀螺矢量和速度矢量的叉乘积：
$$
\begin{align}
&A_{centrifugal}=\omega_{gyro}\times V\\
&V=\left[
\begin{matrix} \tag{Eqn. 25}
velocity\\
0\\
0
\end{matrix}
\right]
\end{align}
$$
注意式25，我们只需要执行两次乘法，因为机体系下速度矢量中两个元素为0.

常规地，市场上三轴加速度计中Z轴是朝下的，向下的重力加速度产生一个正输出。为了修复带有离心加速度的重力加速度值，我们需要添加离心加速度值得估计。因此，机体系下的重力矢量的参考测量值为：
$$
\begin{align}
&g_{reference}=Accelerometer+\omega_{gyro}\times V\\
&Accelerometer=\left[
\begin{matrix}
Accelerometer_x\\
Accelerometer_y\\ \tag{Eqn. 26}
Accelerometer_z
\end{matrix}
\right]
\end{align}
$$


除了重力矢量的基准测量值，我们还需要基于方向余弦矩阵的一个估计值，主要体现在方向余弦矩阵的最后一行，即地球参考坐标系垂直向下轴相对于机体坐标系的投影。

![](../images/accel.png)

在机体系下，横滚俯仰转动的修正矢量，是通过计算方向余弦矩阵的第三行和重力参考矢量归一化后值得叉乘积。
$$
RollPitchCorrectionPlane=\left[
\begin{matrix}
r_{zx}\\
r_{zy}\\ \tag{Eqn. 27}
r_{zz}
\end{matrix}
\right]\times g_{reference}
$$
在非常紧凑连续的转弯中，加速度计也许会饱和。换句话说，实际的运动加速度可能会超出加速度计的测量范围。在那样情况时，将会引入横滚俯仰角度方向的错误估计。控制应避免使加速度计饱和，类似地，陀螺仪也会在这个快速转弯时将会饱和。这个可以通过陀螺仪值反馈校正去限制转动速度。





